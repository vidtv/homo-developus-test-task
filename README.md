## HomoDevelopus API — тестовое задание

Этот проект реализует автоматизированную проверку требований тестового задания для эндпоинтов
`/api/automationTask/create`, `/api/automationTask/getOne`, `/api/automationTask/getAll` и `/api/automationTask/deleteOne/{id}`.

Все проверки выполняются через **REST Assured** + **JUnit 5** + **Allure**.

## Стек

• Java 17
• Maven
• JUnit5
• REST Assured
• Allure
• JSON Schema Validation

## Что покрыто в тестах

Тестовый сценарий реализован как один e2e-тест с Allure steps, полностью соответствующий требованиям задания.

1. Создание 12 игроков

   • Отправка 12 запросов на `/create`

   • Валидация:

   - статус код `201`
   - ответ соответствует JSON Schema (schemas/created_user.json)

   • Сбор всех созданных пользователей (их id)

2. Получение данных одного игрока:

   •	Запрос POST `/getOne` с body, содержащим email одного из созданных игроков

   •	Ожидаемый результат:
   - статус код `201` 
   - валидный объект игрока в соответствии со схемой (schemas/existing_user.json)

3. Получение списка всех игроков + сортировка по имени:

   •	GET `/getAll`

   •	Список десериализуется в List<PlayerResponseDTO>

   •	Выполняется сортировка по имени на стороне теста

4. Удаление всех созданных игроков:

   •	DELETE `/deleteOne/{id}` для каждого созданного игрока

   •	Ожидаемый результат:
   - статус код `200`

5. Проверка, что список пустой:

   •	GET `/getAll`

   •	Ожидаемый результат: пустой массив ([])

## Структура проекта

```text
src
├── main
│    └── java
│         ├── dto/...
│         ├── factory/PlayerFactory.java
│         └── utils/...
├── test
│    ├── java
│    │    ├── tests/HomoDevelopusTests.java
│    └── resources
│         └── schemas
│              ├── created_user.json
│              └── existing_user.json
```

## Авторизация

Авторизация осуществляется через Bearer-токен, который получается через `/tester/login`.

Логин/пароль не хардкожены в тестах — они читаются из:
```
System.getProperty("email", DEFAULT_EMAIL);
System.getProperty("password", DEFAULT_PASSWORD);
```
Если переменные окружения отсутствуют, используются безопасные значения по умолчанию.

## ⚠️ Найденные несоответствия спецификации API

В процессе тестирования выявлены отклонения между Swagger и фактическим поведением API.

1. Формат поля id в ответах создания и получения игрока

   •	В Swagger: integer

   •	Фактически: строка в hex-формате длиной 24 символа (ObjectId-подобный формат)

   •	Обработка: в тестах используется фактическое поведение (тип String).

2. Метод DELETE принимает строковый id

   •	В Swagger: `/deleteOne/{id}` ожидает integer

   •	Фактически: корректно работает только строковый id

   •	Обработка: используется String id.

3. Несоответствия статус-кодов

   •	Swagger иногда указывает 200, а фактический API отдаёт 201.

   •	В тестах зафиксирован фактический статус-код.

4. Порядок полей и дополнительные поля

   •	Некоторые ответы содержат поля, не отражённые в Swagger (например `currency_code`, `password_change`, `password_repeat`, `__v` в респонсе метода создания игрока).

   •	Валидация схем учитывает только наличие и типы необходимых полей, игнорируя порядок полей.

## Запуск тестов

   ```
   mvn clean test
   ```

## Итог

Проект покрывает всё тестовое задание, включает:
- авторизацию,
- создание тестовых данных,
- валидацию структур ответа,
- сортировку,
- удаление,
- финальную проверку.

Код оформлен в структурированном и читаемом виде, с использованием Allure steps.